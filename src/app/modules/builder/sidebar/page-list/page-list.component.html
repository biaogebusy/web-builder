<div class="page-list">
  <div class="reload">
    @if (!loading) {
      <app-btn
        (click)="onReload()"
      [content]="{
        label: '',
        mode: 'icon',
        color: 'primary',
        icon: { svg: 'reload' }
      }"
      ></app-btn>
    }
  </div>
  <app-title
    [content]="{
      label: '管理列表',
      style: 'style-v4',
      classes: 'p-y-xs m-bottom-x bold'
    }"
  ></app-title>
  <div class="form">
    <app-formly
      [fields]="fields"
      [form]="form"
      [model]="model"
      (modelChange)="onModelChange($event)"
    ></app-formly>
  </div>
  <mat-list>
    @if (loading) {
      <mat-spinner diameter="50" color="primary"></mat-spinner>
    }
    @if (content$ | async; as content) {
      @for (page of content; track page; let i = $index) {
        <mat-list-item>
          <div class="title" matListItemLine>
            <a href="{{ page.href }}?preview=true" target="_blank">{{
              page.title
            }}</a>
          </div>
          <div class="meta" matListItemLine>
            {{ page.user | shorten: 6:"..." }}
            {{ page.changed | date: "yyyy/MM/dd HH:mm" }}
          </div>
          <div class="meta" matListItemLine>
            <a href="{{ page.href }}?preview=true" target="_blank">{{
              page.href
            }}</a>
          </div>
          <app-btn
            matListItemMeta
            (click)="loadPage(page)"
            [content]="{ label: '编辑', mode: 'stroked', color: 'primary' }"
          ></app-btn>
        </mat-list-item>
      }
    }
  </mat-list>
  <app-pagination-links
    (pageChange)="onPageChange($event)"
    [links]="links"
  ></app-pagination-links>
</div>

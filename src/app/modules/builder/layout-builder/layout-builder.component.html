<div class="layout-builder position-relative" *ngIf="content">
  <a class="anchor" *ngIf="content.id" [id]="content.id"></a>
  <app-spacer [size]="content?.spacer || 'md'"></app-spacer>
  <app-bg-img [attr.data-path]="'bg'" [content]="content.bg" *ngIf="content.bg"></app-bg-img>
  <div class="{{content.fullWidth?'':'container'}}" *ngIf="content">
    <div class="inner layout-inner" id="layout" fxLayout="row wrap" [fxLayoutAlign]="content.layoutAlign">
      <div class="layout" fxFlex.xs="calc(100% / {{12 / layout.row.xs}})"
        fxFlex.sm="calc(100% / {{12 / layout.row.sm}})" fxFlex.md="0 0 calc(100% / {{12 / layout.row.md}})"
        fxFlex.lg="0 0 calc(100% / {{12 / layout.row.lg}})" fxFlex.gt-lg="0 0 calc(100% / {{12 / layout.row.lg}})"
        [ngClass]="layout.classes" *ngFor="let layout of content.elements;index as i" [attr.data-path]="'elements.'+i">
        <div class="block" fxLayout="column">
          <div class="block-toolbar" *ngIf="enable_toolbar$ | async">
            <app-btn matTooltip="新增组件到当前列" (click)="addBlock('down',i,content)"
              [content]="{label:'', mode: 'icon',icon:{svg:'image-multiple' } }"></app-btn>
            <app-btn matTooltip="新增栏" (click)="addBlock('next',i,content)"
              [content]="{label:'', mode: 'icon',icon:{svg:'view-grid-plus' } }"></app-btn>
            <app-btn matTooltip="左对齐" (click)="onAlign(i,'start stretch')"
              [content]="{label:'', mode: 'icon',icon:{svg:'format-align-left' } }"></app-btn>
            <app-btn matTooltip="居中对齐" (click)="onAlign(i,'center stretch')"
              [content]="{label:'', mode: 'icon',icon:{svg:'format-align-center' } }"></app-btn>
            <app-btn matTooltip="右对齐" (click)="onAlign(i,'end stretch')"
              [content]="{label:'', mode: 'icon',icon:{svg:'format-align-right' } }"></app-btn>
            <app-btn matTooltip="移除当前栏" (click)="onDeleteRow(i)"
              [content]="{label:'', mode: 'icon',icon:{svg:'trash-can-outline',inline:true } }"></app-btn>
            <app-btn matTooltip="显示网格" (click)="onShowGrid()"
              [content]="{label:'',color:showGrid?'primary' : undefined, mode: 'icon',icon:{svg:'view-column',inline:true } }"></app-btn>
            <app-btn matTooltip="更多设置" (click)="onSettings(i,layout)"
              [content]="{label:'', mode: 'icon',icon:{svg:'responsive',inline:true } }"></app-btn>
          </div>
          <div class="item" *ngFor="let item of layout.elements;index as index" [fxFlexAlign]="layout.align">
            <div class="actions" *ngIf="enable_toolbar$ | async">
              <app-btn *ngIf="index > 0 && index < layout.elements.length" (click)="onMove('up',i,index)"
                [content]="{label:'',color:'primary', mode: 'icon' ,icon:{svg:'arrow-collapse-up',inline:true } }"></app-btn>
              <app-btn *ngIf="index > -1 && index < layout.elements.length -1" (click)="onMove('down',i,index)"
                [content]="{label:'',color:'primary', mode: 'icon' ,icon:{svg:'arrow-collapse-down',inline:true } }"></app-btn>
              <app-btn (click)="onDeleteCol(i,index)"
                [content]="{label:'',color:'primary', mode: 'icon' ,icon:{svg:'delete',inline:true } }"></app-btn>
            </div>
            <app-dynamic-component [attr.data-path]="'elements.'+index" [inputs]="item">
            </app-dynamic-component>
          </div>
        </div>
      </div>
      <div class="layout-preview" *ngIf="enable_toolbar$ | async">
        <ng-container *ngIf="showGrid">
          <div class="col-item" *ngFor="let item of [1,2,3,4,5,6,7,8,9,10,11,12]">
            <div class="span">{{item}}</div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
  <app-spacer [size]="content?.spacer || 'md'"></app-spacer>
</div>
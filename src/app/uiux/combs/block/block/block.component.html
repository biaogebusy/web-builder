<div class="block" *ngIf="pageContent$ | async as page">
  <mat-drawer-container (backdropClick)="onBackdrop()">
    <mat-drawer-content>
      <div *ngTemplateOutlet="block; context: {content:page.body}"></div>
    </mat-drawer-content>
    <mat-drawer (openedChange)="onDrawer()" class="drawer-right" [mode]="'over'" [opened]="opened" position="end">
      <div class="drawer-loading" *ngIf="drawerLoading">
        <mat-spinner diameter="50" color="accent"></mat-spinner>
      </div>
      <ng-container *ngIf="!drawerLoading && opened">
        <div *ngTemplateOutlet="block; context: {content:drawerContent?.body,isBuilder:coreConfig?.enableBuilder}; ">
        </div>
      </ng-container>
    </mat-drawer>
  </mat-drawer-container>
</div>

<ng-template let-content="content" let-isBuilder="isBuilder" #block>
  <ng-container *ngIf="!isBuilder">
    <app-dynamic-component *ngFor="let item of content;index as i; trackBy: trackByFn" [inputs]="item"
      [index]="i"></app-dynamic-component>
  </ng-container>

  <ng-container *ngIf="isBuilder">
    <div cdkDropList class="builder-list" (cdkDropListDropped)="drop($event)">
      <app-dynamic-component cdkDrag *ngFor="let item of content;index as i; trackBy: trackByFn" [inputs]="item"
        [index]="i" [isBuilder]="isBuilder"></app-dynamic-component>
    </div>
  </ng-container>
</ng-template>
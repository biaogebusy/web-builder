import { Meta } from "@storybook/addon-docs";

<Meta
  title="Drupal/相关文档/JSONAPI/文件"
  id="jsonapi-system"
  parameters={{
    viewMode: "docs",
    previewTabs: {
      canvas: { hidden: true },
    },
    layout: "fullscreen",
  }}
/>

Drupal 系统相关的信息

## 获取文件列表

```
GET {{apiUrl}}/api/v1/file/file
```

## 上传文件

需要注意，上传的文件为临时文件，需要在后台更改文件系统中设置为永久文件。

```
 uploadImage(
    fileName: string,
    imageData: any,
    csrfToken: string
  ): Observable<any> {
    return this.http
      .post('/api/v1/media/image/field_media_image', imageData, {
        headers: new HttpHeaders({
          Accept: 'application/vnd.api+json',
          'Content-Type': 'application/octet-stream',
          'Content-Disposition': `file; filename="${fileName}"`,
          'X-CSRF-Token': csrfToken,
        }),
        withCredentials: true,
      })
      .pipe(
        map((res: any) => {
          const {
            data: {
              attributes: { uri },
            },
          } = res;
          return uri.url;
        }),
        catchError(() => {
          return '';
        })
      );
  }
```

## 获取区块信息

```
GET {{apiUrl}}/api/v1/block_content_type/block_content_type
```
